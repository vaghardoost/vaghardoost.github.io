<!DOCTYPE html><html dir="rtl"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous"/><link rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/9ddc91bf10736b63.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9ddc91bf10736b63.css" data-n-g=""/><link rel="preload" href="/_next/static/css/57fa2be5d6c0cdd1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/57fa2be5d6c0cdd1.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-673a4fae4a27af6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-78a051c38553426e.js" defer=""></script><script src="/_next/static/chunks/321-e6cc1b00c4d45973.js" defer=""></script><script src="/_next/static/chunks/9-91ee39ab5b55f745.js" defer=""></script><script src="/_next/static/chunks/281-4d6c20d89395e092.js" defer=""></script><script src="/_next/static/chunks/pages/note/%5Btitle%5D-9726dd10b352e051.js" defer=""></script><script src="/_next/static/8wfrNpLGQEQ7YKgWthgX8/_buildManifest.js" defer=""></script><script src="/_next/static/8wfrNpLGQEQ7YKgWthgX8/_ssgManifest.js" defer=""></script><style id="__jsx-9816238a097d8b2c">li.jsx-9816238a097d8b2c{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex}</style><style id="__jsx-3528661697">.cardHeader.jsx-3528661697{background:url(/_next/static/media/header.8d53fe0d.png)#40862d;height:120px;text-align:center;-webkit-border-radius:15px 15px 0 0;-moz-border-radius:15px 15px 0 0;border-radius:15px 15px 0 0;background-position:center;-webkit-background-size:600px;-moz-background-size:600px;-o-background-size:600px;background-size:600px;margin-bottom:40px}</style></head><body><div id="__next"><div class="jsx-9816238a097d8b2c navbar_navbar__jP4A8"><div class="nav container"><ul class="jsx-9816238a097d8b2c"><li class="jsx-9816238a097d8b2c"> <a class="navbar_navLink__lrkv8" href="/">صفحه ی اصلی</a> </li><li class="jsx-9816238a097d8b2c"> <a class="navbar_navLink__lrkv8" href="/category">دسته بندی ها</a> </li><li class="jsx-9816238a097d8b2c"> <a class="navbar_navLink__lrkv8" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js#">درباره ما</a> </li></ul></div></div><div class="container"><div class="row"><div class="col-md-8"><div class="jsx-3528661697 note_card__oGU9m note_meduimFont__yRcxR around margin"><div class="jsx-3528661697 note_title__npIjl"><h1 class="jsx-3528661697">متن بسته های node.js</h1><p class="jsx-3528661697">۱۴۰۱/۱۱/۳۰</p></div><div style="margin:20px"><p>این درسته که بخاطر open source شدن نرم افزار ها توسعه ی اون شدت زیادی گرفت. ولی هنوز بستن کد منبع رواج داره و تمام دلیلش بحث های امنیتی و سو استفاده هاست.</p></div><h3 id="پیش گفتار" style="margin:10px">پیش گفتار</h3><div style="margin:20px"><p>گاها پروژه ای رو باید تحویل بدید که کد منبع اون غیرقابل خوندن باید باشه. برای مثال ازین بابت که ممکنه کد شما حفره هایی داشته باشه یا ساختار طوری باشه که بعضی خرابکار ها بیان و کد شما رو مطالعه کنن ، شما برای انتشار یک کد منبع بسته رو تحویل میدید که اجرا میشه ولی کد اون قابل خوندن نیست.</p></div><h3 id="webpack" style="margin:10px">webpack</h3><div class="photo_cardContainer__WllSo"><div class="photo_card__rdmx2"><img class="photo_cardImgSolid__Cdop8" src="/images/01f1d0f60a43058346163de878d88271.jpeg"/></div></div><div style="margin:20px"><p>کدهای جاوااسکریپت برای توسعه پذیری و درک بهتر برای برنامه نویس و در کل انسان ، بین فایل های مختلف تقسیم میشه. این کار زیاد تاثیری روی performance نداره ولی بهرحال بیانگر ساختاری و سازماندهی کد شماست.</p><p>توی خیلی زبان های برنامه نویسی گاها شما ممکنه یک جمله ای رو شنیده باشید که گاها میگن <b>فایل bundle</b> منظور از فایل باندل همین بحث هست که میاد و تمام import ها و export ها توی فایل ها از بین میره و همه چی توی یک فایل جمع میشه.</p><p>برای جاوااسکریپت ابزاری هست به اسم webpack که میاد و همه ی فایل هایی که شما نوشتی رو توی یک فایل باندل میاره.</p></div><div class="center"><div class="frame_frame__P5_oT"><p><i>البته گستره کار با webpack بیشتر از این صحبت هاست ولی توی این سناریو ما میخوایم از webpack برای بستن کد منبع استفاده کنیم</i></p></div></div><div style="margin:20px"><p>کتابخانه ی webpack برای اینکه متوجه بشه که شما ساختار دقیق پروژه شما چطوریه و شما ازش چی میخواید ، یک فایل رو میخونه و براساس اون فایل باندل رو ایجاد میکنه.</p><p>شما باید روی root پروژه ، ینی همون فولدر اصلی ، یک فایل ایجاد کنید به اسم webpack.config.js که این فایل یک خروجی داره و اون خروجی آپشن هایی هست که webpack اون رو میخونه و اساس بر اون میشه.</p></div><div class="around" dir="ltr"><code><pre>const fs = require(&quot;fs&quot;);
const path = require(&quot;path&quot;);

const node_modules = {};
fs.readdirSync(&quot;./node_modules&quot;)
    .filter((name) =&gt; {
        return [&quot;.bin&quot;].indexOf(name) === -1;
    })
    .forEach((name) =&gt; {
        node_modules[name] = `commonjs ${name}`;
    });

module.exports = {
    entry: &quot;./index.js&quot;,
    target: &quot;node&quot;,
    output: {
        path: path.join(__dirname, &quot;build&quot;),
        filename: &quot;bundle.js&quot;,
    },
    externals: node_modules,
};
</pre></code></div><div style="margin:20px"><p>کد بالا یک نمونه ساده از یک فایل کانفیگ برای webpack هست. در قسمت module.export که اون نتیجه نهایی برای فایل هست یک سری گزینه ها هست که یکی یکی اونها رو شرح میدم.</p><p><b>entry:</b> همون فایل اصلی رو نشون میده اونی که شروع کننده هست و همه ی import ها از اون شروع میشه...</p><p><b>target:</b> بیانگر اینه که کجا قراره این کد اجرا بشه ینی server side هست یا client side. اگر برای مثال شما بخواید برای react خروجی بگیرید مقدار اون متفاوت میشه.</p><p><b>output:</b> فایل باندل که ایجاد کردید کجا قرار میگیره،آدرس دقیق اون که با استفاده از ماژول path انجام میشه.</p><p><b>externals:</b> دایرکتوری node_module خیلی خیلی عمیق و شلوغ هست. گاها نشون دادن عمق فایل های موجود در اون خیلی زیاد میشه و یه جورایی ضعف نود جی اس هم حساب میشه اما ، اگر شما لازم باشه فایل های این رو هم توی فایل باندل خودتون جا کنید خیلی خیلی فایل بزرگ میشه و بقول معروف anti pattern هست. برای همین فایل باندل بهتره node_module رو توی خودش import کنه و هر فایلی قراره توی باندل import بشه با این گزینه شدنی هست.</p><p>به استثنا دایرکتوری bin. بقیه تحت عنوان common {name} توی یک کلید مقدار به external اصطلاحا پاس داده میشه.</p></div><div class="center"><div class="frame_frame__P5_oT"><p><i>با استفاده از یک دستور ینی npx webpack init میتونید یک فایل webpack ایجاد کنین اما ممکنه بعضی از ساختار فایلهای شما رو تغییر بده برای همین پیشنهاد میکنم خودتون این فایل رو ایجاد کنید که هم به کار مسلط تر بشید هم ساختار حفظ شه</i></p></div></div><h3 id="bytenode" style="margin:10px">bytenode</h3><div style="margin:20px"><p>یکی از کتابخانه هایی که برای node js هست و فایل ها رو به صورت بایت کد در میاره کتابخانه ای به اسم bytenode هست. برای اجرا هم دیگه نمیشه برای اجرا مستقیم این فایل رو به node ارجا داد. برای همین باید از همین کتابخانه استفاده کرد. ضرورت ساختن فایل باندل به اینجا برمیگرده یعنی موقعی که اجرای bytenode حتما باید یک فایل یکپارچه داشت.</p></div><div class="photo_cardContainer__WllSo"><div class="photo_card__rdmx2"><img class="photo_cardImgSolid__Cdop8" src="/images/34eb3d92f22eb96f4f79961faf58fba0.png"/></div></div><h3 id="مثال" style="margin:10px">مثال</h3><div style="margin:20px"><p>حالا تصور میکنیم که فایل کانفیگ webpack رو به ترتیب بالا داریم. باید اول webpack رو نصب کنیم بعد با استفاده از دستور خودش فایل bundle رو بسازیم ، با bytenode از روی فایل باندل یک فایل بایت کد درست کنیم و در آخر هم با همون bytenode فایل باینری رو دانلود کنیم.</p></div><div class="around" dir="ltr"><code><pre>// install webpack
npm install webpack webpack-cli

// build bundle with webpack.config.js
npx webpack

// install bytenode
npm install bytenode

// build bytecodes with bytenode
npx bytenode ./build/bundle.js

// run bytecode with bytenode
npx bytenode bundle.jsb</pre></code></div><div style="margin:20px"><p>bytenode تنها کاری که میکنه باینری کردن یا فقط خواندنی کردن فایل js هست. اصل کار زمانی هست که با webpack کار میکنید. معرفی webpack رو توی نوشته دیگه ای توضیح میدم.</p></div></div></div><div class="col-md-4"><div class="category_card___5fn2"><div style="background-position:center;background:url(/_next/static/media/header.8d53fe0d.png) #40862d;background-size:600px;height:125px;text-align:center;border-radius:15px 15px 0 0;margin-bottom:30px"><img class="category_image__80jhs" src="/images/b568390d649f2d3bdc87f26f9c3c882a.png"/></div><div class="category_card_content__puyqm around center"><h4>دنیای node.js</h4><p>نوشته های مربوط به مباحث نود جی اس ، فریم ورک ها ، کتابخانه های آن </p><ul><li><a class="link" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js">متن بسته های node.js</a></li><li><a class="link" href="/note/%D8%B1%D8%A7%D9%87%DB%8C_%D8%A8%D9%87_%D8%A7%D8%B3%D9%85_nextjs">راهی به اسم nextjs</a></li></ul></div></div><div class="jsx-3528661697 sticky-top"><div class="jsx-3528661697 note_card__oGU9m note_card_links__0rN6I around"><h4 class="jsx-3528661697 around center">متن بسته های node.js</h4><ul class="jsx-3528661697"><li class="jsx-3528661697"><a class="note_link__N_Jxr" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js#%D9%BE%DB%8C%D8%B4%20%DA%AF%D9%81%D8%AA%D8%A7%D8%B1"> <!-- -->پیش گفتار<!-- --> </a></li><li class="jsx-3528661697"><a class="note_link__N_Jxr" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js#webpack"> <!-- -->webpack<!-- --> </a></li><li class="jsx-3528661697"><a class="note_link__N_Jxr" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js#bytenode"> <!-- -->bytenode<!-- --> </a></li><li class="jsx-3528661697"><a class="note_link__N_Jxr" href="/note/%D9%85%D8%AA%D9%86_%D8%A8%D8%B3%D8%AA%D9%87_%D9%87%D8%A7%DB%8C_node.js#%D9%85%D8%AB%D8%A7%D9%84"> <!-- -->مثال<!-- --> </a></li></ul></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"b98a71cf-71b0-4613-b75e-bafe7c9a5a39","title":"متن بسته های node.js","content":[{"richtext":[{"content":[{"text":"این درسته که بخاطر open source شدن نرم افزار ها توسعه ی اون شدت زیادی گرفت. ولی هنوز بستن کد منبع رواج داره و تمام دلیلش بحث های امنیتی و سو استفاده هاست.","style":{"weight":[]}}]}],"id":"ac7382c5","type":"caption"},{"header":"h3","text":"پیش گفتار","id":"f5c6b432","type":"title"},{"richtext":[{"content":[{"text":"گاها پروژه ای رو باید تحویل بدید که کد منبع اون غیرقابل خوندن باید باشه. برای مثال ازین بابت که ممکنه کد شما حفره هایی داشته باشه یا ساختار طوری باشه که بعضی خرابکار ها بیان و کد شما رو مطالعه کنن ، شما برای انتشار یک کد منبع بسته رو تحویل میدید که اجرا میشه ولی کد اون قابل خوندن نیست.","style":{"weight":[]}}]}],"id":"a12b805f","type":"caption"},{"header":"h3","text":"webpack","id":"631a8e14","type":"title"},{"richtext":[],"url":"http://localhost:31375/photo/01f1d0f60a43058346163de878d88271.jpeg","id":"d8207e99","type":"photo"},{"richtext":[{"content":[{"text":"کدهای جاوااسکریپت برای توسعه پذیری و درک بهتر برای برنامه نویس و در کل انسان ، بین فایل های مختلف تقسیم میشه. این کار زیاد تاثیری روی performance نداره ولی بهرحال بیانگر ساختاری و سازماندهی کد شماست.","style":{"weight":[]}}]},{"content":[{"text":"توی خیلی زبان های برنامه نویسی گاها شما ممکنه یک جمله ای رو شنیده باشید که گاها میگن ","style":{"weight":[]}},{"text":"فایل bundle","style":{"weight":["BOLD"]}},{"text":" منظور از فایل باندل همین بحث هست که میاد و تمام import ها و export ها توی فایل ها از بین میره و همه چی توی یک فایل جمع میشه.","style":{"weight":[]}}]},{"content":[{"text":"برای جاوااسکریپت ابزاری هست به اسم webpack که میاد و همه ی فایل هایی که شما نوشتی رو توی یک فایل باندل میاره.","style":{"weight":[]}}]}],"id":"d6f28ec1","type":"caption"},{"richtext":[{"content":[{"text":"البته گستره کار با webpack بیشتر از این صحبت هاست ولی توی این سناریو ما میخوایم از webpack برای بستن کد منبع استفاده کنیم","style":{"weight":["ITALIC"]}}]}],"id":"7a6b1d29","type":"frame"},{"richtext":[{"content":[{"text":"کتابخانه ی webpack برای اینکه متوجه بشه که شما ساختار دقیق پروژه شما چطوریه و شما ازش چی میخواید ، یک فایل رو میخونه و براساس اون فایل باندل رو ایجاد میکنه.","style":{"weight":[]}}]},{"content":[{"text":"شما باید روی root پروژه ، ینی همون فولدر اصلی ، یک فایل ایجاد کنید به اسم webpack.config.js که این فایل یک خروجی داره و اون خروجی آپشن هایی هست که webpack اون رو میخونه و اساس بر اون میشه.","style":{"weight":[]}}]}],"id":"b0e598cb","type":"caption"},{"text":"const fs = require(\"fs\");\nconst path = require(\"path\");\n\nconst node_modules = {};\nfs.readdirSync(\"./node_modules\")\n    .filter((name) =\u003e {\n        return [\".bin\"].indexOf(name) === -1;\n    })\n    .forEach((name) =\u003e {\n        node_modules[name] = `commonjs ${name}`;\n    });\n\nmodule.exports = {\n    entry: \"./index.js\",\n    target: \"node\",\n    output: {\n        path: path.join(__dirname, \"build\"),\n        filename: \"bundle.js\",\n    },\n    externals: node_modules,\n};\n","id":"ace7c43c","type":"code"},{"richtext":[{"content":[{"text":"کد بالا یک نمونه ساده از یک فایل کانفیگ برای webpack هست. در قسمت module.export که اون نتیجه نهایی برای فایل هست یک سری گزینه ها هست که یکی یکی اونها رو شرح میدم.","style":{"weight":[]}}]},{"content":[{"text":"entry:","style":{"weight":["BOLD"]}},{"text":" همون فایل اصلی رو نشون میده اونی که شروع کننده هست و همه ی import ها از اون شروع میشه...","style":{"weight":[]}}]},{"content":[{"text":"target:","style":{"weight":["BOLD"]}},{"text":" بیانگر اینه که کجا قراره این کد اجرا بشه ینی server side هست یا client side. اگر برای مثال شما بخواید برای react خروجی بگیرید مقدار اون متفاوت میشه.","style":{"weight":[]}}]},{"content":[{"text":"output:","style":{"weight":["BOLD"]}},{"text":" فایل باندل که ایجاد کردید کجا قرار میگیره،آدرس دقیق اون که با استفاده از ماژول path انجام میشه.","style":{"weight":[]}}]},{"content":[{"text":"externals:","style":{"weight":["BOLD"]}},{"text":" دایرکتوری node_module خیلی خیلی عمیق و شلوغ هست. گاها نشون دادن عمق فایل های موجود در اون خیلی زیاد میشه و یه جورایی ضعف نود جی اس هم حساب میشه اما ، اگر شما لازم باشه فایل های این رو هم توی فایل باندل خودتون جا کنید خیلی خیلی فایل بزرگ میشه و بقول معروف anti pattern هست. برای همین فایل باندل بهتره node_module رو توی خودش import کنه و هر فایلی قراره توی باندل import بشه با این گزینه شدنی هست.","style":{"weight":[]}}]},{"content":[{"text":"به استثنا دایرکتوری bin. بقیه تحت عنوان common {name} توی یک کلید مقدار به external اصطلاحا پاس داده میشه.","style":{"weight":[]}}]}],"id":"4c0cbcbf","type":"caption"},{"richtext":[{"content":[{"text":"با استفاده از یک دستور ینی npx webpack init میتونید یک فایل webpack ایجاد کنین اما ممکنه بعضی از ساختار فایلهای شما رو تغییر بده برای همین پیشنهاد میکنم خودتون این فایل رو ایجاد کنید که هم به کار مسلط تر بشید هم ساختار حفظ شه","style":{"weight":["ITALIC"]}}]}],"id":"4a0dfa44","type":"frame"},{"header":"h3","text":"bytenode","id":"a3c906ef","type":"title"},{"richtext":[{"content":[{"text":"یکی از کتابخانه هایی که برای node js هست و فایل ها رو به صورت بایت کد در میاره کتابخانه ای به اسم bytenode هست. برای اجرا هم دیگه نمیشه برای اجرا مستقیم این فایل رو به node ارجا داد. برای همین باید از همین کتابخانه استفاده کرد. ضرورت ساختن فایل باندل به اینجا برمیگرده یعنی موقعی که اجرای bytenode حتما باید یک فایل یکپارچه داشت.","style":{"weight":[]}}]}],"id":"e2db6011","type":"caption"},{"richtext":[],"url":"http://localhost:31375/photo/34eb3d92f22eb96f4f79961faf58fba0.png","id":"f6726f17","type":"photo"},{"header":"h3","text":"مثال","id":"b6dc8420","type":"title"},{"richtext":[{"content":[{"text":"حالا تصور میکنیم که فایل کانفیگ webpack رو به ترتیب بالا داریم. باید اول webpack رو نصب کنیم بعد با استفاده از دستور خودش فایل bundle رو بسازیم ، با bytenode از روی فایل باندل یک فایل بایت کد درست کنیم و در آخر هم با همون bytenode فایل باینری رو دانلود کنیم.","style":{"weight":[]}}]}],"id":"ef40d827","type":"caption"},{"text":"// install webpack\nnpm install webpack webpack-cli\n\n// build bundle with webpack.config.js\nnpx webpack\n\n// install bytenode\nnpm install bytenode\n\n// build bytecodes with bytenode\nnpx bytenode ./build/bundle.js\n\n// run bytecode with bytenode\nnpx bytenode bundle.jsb","id":"33123e0e","type":"code"},{"richtext":[{"content":[{"text":"bytenode تنها کاری که میکنه باینری کردن یا فقط خواندنی کردن فایل js هست. اصل کار زمانی هست که با webpack کار میکنید. معرفی webpack رو توی نوشته دیگه ای توضیح میدم.","style":{"weight":[]}}]}],"id":"7512e19a","type":"caption"}],"author":1,"createAt":"1676759668256","tag":[],"category":{"id":"09ae92b9-ff31-41e3-be66-c3519775a853","label":"دنیای node.js","admin":1,"description":"نوشته های مربوط به مباحث نود جی اس ، فریم ورک ها ، کتابخانه های آن ","avatar":"b568390d649f2d3bdc87f26f9c3c882a.png","color":"#40862d","_id":"63bfcc12d5c3ef370090fcde","notes":[{"id":"b98a71cf-71b0-4613-b75e-bafe7c9a5a39","title":"متن بسته های node.js","author":1,"createAt":"1676759668256","tag":[],"category":"09ae92b9-ff31-41e3-be66-c3519775a853"},{"id":"6c1177b4-eaa0-4d8f-99f5-9a9986c5ddbf","title":"راهی به اسم nextjs","author":1,"createAt":"1676587461231","tag":[],"category":"09ae92b9-ff31-41e3-be66-c3519775a853"}]}}},"__N_SSG":true},"page":"/note/[title]","query":{"title":"متن_بسته_های_node.js"},"buildId":"8wfrNpLGQEQ7YKgWthgX8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>